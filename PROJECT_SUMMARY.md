# خلاصه پروژه رمزنیوز نسل ۲

## اطلاعات دیپلوی

- آدرس پروژه: https://ramznews-gen2.liimonhazee.workers.dev
- وب هوک تلگرام: https://ramznews-gen2.liimonhazee.workers.dev/webhook
- وضعیت سلامت: https://ramznews-gen2.liimonhazee.workers.dev/health

## امکانات اصلی

1. **دریافت خودکار اخبار**: هر 10 دقیقه از منابع RSS
2. **پردازش هوشمند با هوش مصنوعی**: استفاده از OpenRouter و مدل mistralai/mixtral-8x7b
3. **ارسال خودکار به تلگرام**: هر دقیقه، پست‌های پردازش شده به کانال ارسال می‌شوند
4. **پشتیبانی از وب هوک تلگرام**: امکان تعامل دوطرفه با کاربران

## مسیرهای API

### مسیرهای اصلی
- `/health`: بررسی وضعیت سلامت سیستم
- `/setup-webhook`: تنظیم وب هوک تلگرام
- `/webhook-info`: دریافت اطلاعات وب هوک فعلی
- `/delete-webhook`: حذف وب هوک

### مسیرهای عیب‌یابی
- `/trigger-fetch`: فراخوانی دستی دریافت فیدهای RSS
- `/check-queue`: بررسی وضعیت صف پردازش
- `/init-queue`: مقداردهی اولیه صف با یک پست آزمایشی
- `/process-queue`: پردازش دستی صف و ارسال به تلگرام

## تنظیمات

تمامی تنظیمات در فایل `config.js` قرار دارند:

- توکن بات تلگرام: `7901847454:AAHiID4x5SDdZCNbwgYd3vVLmRnKVl10J78`
- کانال تلگرام: `@ramznewsofficial`
- کلید API هوش مصنوعی: از طریق Secrets تنظیم شده است

## وظایف زمان‌بندی شده (Cron Jobs)

- هر 10 دقیقه: دریافت فیدهای RSS
- هر دقیقه: پردازش و ارسال به تلگرام

## نگهداری

برای به‌روزرسانی پروژه پس از تغییرات:

```bash
npx wrangler deploy
```

برای مشاهده لاگ‌ها:

```bash
npx wrangler tail
```

برای تغییر منابع RSS، فایل `config.js` را ویرایش کنید.

## عیب‌یابی

اگر پست‌ها به کانال تلگرام ارسال نمی‌شوند:

1. ابتدا با مسیر `/check-queue` بررسی کنید که آیا صف پردازش خالی است یا خیر
2. اگر صف خالی است، با مسیر `/trigger-fetch` دریافت فیدها را به صورت دستی انجام دهید
3. سپس دوباره صف را بررسی کنید تا مطمئن شوید داده‌ها دریافت شده‌اند
4. اگر صف همچنان خالی است، با مسیر `/init-queue` یک پست آزمایشی ایجاد کنید
5. با مسیر `/process-queue` پردازش دستی صف را انجام دهید
6. لاگ‌های برنامه را با دستور `npx wrangler tail` بررسی کنید 